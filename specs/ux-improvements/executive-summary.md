# UX Improvements - Executive Summary

**Document Date:** 2025-12-11
**Product Director:** Claude AI
**Full Requirements:** [requirements.md](./requirements.md)

---

## TL;DR - Critical Insights

### Problem 1: 销量预测页面 - 效率瓶颈
**现状：** 一次只能编辑一个周的数据，需要反复选择周次 → 加载 → 编辑 → 保存
**影响：** 更新8个SKU x 12周的预测需要10-15分钟
**推荐方案：** 矩阵表格视图（SKU行 x 周列），支持批量编辑
**预期收益：** 效率提升 **5-10倍**（缩短至<2分钟）

---

### Problem 2: PSI报表 vs 算法验证 - 功能定位不清
**现状：** 用户认为两个页面有30-40%重复，不清楚该用哪个
**根本原因：** 页面命名和UI设计未突出差异化价值
**真实情况：** 功能重叠仅25%，分别服务不同场景：
  - **PSI报表：** 历史分析（过去12周）→ 供应链分析师、财务
  - **算法验证：** 未来规划（当前周+12周）→ 采购经理

**推荐方案：**
1. **重命名页面**
   - PSI报表 → "库存周转报表 (Inventory Turnover Report)"
   - 算法验证 → "补货计划验证 (Replenishment Plan Validator)"
2. **UI视觉差异化**
   - PSI用绿/蓝财务风格 + "导出Excel"按钮
   - 算法验证用橙/紫规划风格 + "运行模拟"按钮
3. **添加对比说明**
   - 在每个页面顶部显示"何时使用此页面"的帮助文本
4. **功能隔离**
   - PSI增加库存周转率、断货天数统计
   - 算法验证增加Lead Time可视化、假设场景分析

**预期收益：** 用户认知混淆度从40% → **<10%**

---

### Problem 3: 需求覆盖 - 缺乏多周汇总
**现状：** 一个PO可能覆盖多周需求，但表格按(周,SKU,渠道)拆分成多行，用户需手工计算汇总
**影响：** 采购决策时间：每个SKU需3-5分钟（手工加总4周x4渠道=16行）
**推荐方案：** 分阶段实现
  - **Phase 1 (MVP):** 按SKU汇总多周需求，支持展开/折叠查看明细
  - **Phase 2:** 支持多选行，一次性分配一个PO到多周需求
  - **Phase 3:** 智能推荐最佳PO匹配（基于供应商、Lead Time、剩余容量）

**预期收益：** 采购决策时间缩短 **40-60%**（从5分钟 → <1分钟/SKU）

---

## 详细对比表

| 维度 | PSI报表 | 算法验证 | 重叠度 |
|------|---------|---------|--------|
| **时间视角** | 过去+当前 | 未来（+当前用于验证） | 25% |
| **核心指标** | 库存余额 | 下单数量 | 0% |
| **数据来源（到货）** | 实际出入库记录 | PO计划下单 | 30% |
| **数据来源（销售）** | 实际+预测 | 仅预测 | 20% |
| **决策输出** | 库存状态（OK/Risk/Stockout） | 下单缺口（建议 vs 实际） | 0% |
| **用户操作** | 查看趋势、发现问题 | 验证算法、调整订单 | 0% |
| **典型用户** | 供应链分析师、财务 | 采购经理、供应链总监 | 20% |
| **典型问题** | "过去3个月库存周转率多少？" | "这批PO什么时候到？下单量够吗？" | 0% |

**总体重叠度：** ~25%（可接受范围，无需合并）

---

## 关键决策建议

### 优先级排序（基于业务价值 x 实现成本）

| 序号 | 改进项 | 业务价值 | 实现复杂度 | 优先级 | 建议排期 |
|-----|--------|---------|-----------|--------|----------|
| **1** | 问题2：页面重命名+UI差异化 | 高（降低认知负担） | 低（1周） | **P0** | 立即执行 |
| **2** | 问题3：Phase 1汇总视图 | 极高（直接提效） | 中（2周） | **P0** | Q1 2026 |
| **3** | 问题1：矩阵表格MVP | 极高（10倍效率提升） | 高（3-4周） | **P1** | Q1 2026 |
| **4** | 问题3：Phase 2多周分配 | 高（完善工作流） | 中（2周） | **P2** | Q2 2026 |
| **5** | 问题1：趋势可视化 | 中（锦上添花） | 中（1周） | **P3** | Q2 2026 |
| **6** | 问题3：Phase 3智能推荐 | 中（自动化） | 高（3周） | **P4** | Future |

---

## 技术影响评估

### 数据库变更
- **新表：** 无
- **新视图：** `v_forecast_coverage_aggregated`（汇总视图）
- **表结构变更：** 无

### API变更
- **新增Server Actions:**
  - `bulkUpdateForecasts(changes[])` - 批量更新预测
  - `bulkAllocateToOrder(forecastIds[], poId, qty)` - 批量分配
- **性能优化需求:**
  - `calculatePSI()` - 需支持100+ SKU并发查询
  - `v_forecast_coverage` - 需添加索引优化聚合查询

### 前端组件
- **新组件:**
  - `<MatrixTable>` - 可复用的矩阵编辑表格（类Excel）
  - `<AggregatedTable>` - 支持展开/折叠的分层表格
  - `<AllocationModal>` - PO分配弹窗
- **组件库需求:** 无新增依赖（基于现有Shadcn + Recharts）

---

## ROI分析

### 定量收益（年化）

假设条件：
- 3名需求计划员，每人每周更新预测2次
- 2名采购经理，每人每天处理覆盖率分析5次
- 1名分析师，每周使用PSI/算法验证5次

| 改进项 | 节省时间/次 | 年频次 | 年节省工时 | 按时薪¥200计算 | 年收益 |
|--------|-------------|--------|-----------|---------------|--------|
| 问题1解决 | 12分钟 | 3人x2次x52周=312 | 62小时 | ¥200 | **¥12,400** |
| 问题3解决 | 3分钟 | 2人x5次x250天=2500 | 125小时 | ¥200 | **¥25,000** |
| 问题2解决 | 节省查找时间1分钟 | 3人x5次x52周=780 | 13小时 | ¥200 | **¥2,600** |
| **合计** | - | - | **200小时/年** | - | **¥40,000/年** |

### 定性收益
- **决策质量提升：** 更清晰的覆盖率视图 → 减少断货/滞销风险
- **员工满意度：** 减少重复劳动，提升工具体验
- **可扩展性：** 矩阵表格组件可复用到其他批量编辑场景（库存调整、价格管理等）

---

## 风险与缓解

| 风险 | 影响 | 可能性 | 缓解措施 |
|------|------|--------|----------|
| 矩阵表格性能差（200+ SKU） | 用户体验下降 | 中 | 添加虚拟滚动+分页 |
| 用户不适应新UI | 采用率低 | 中 | 保留旧版"快速编辑"模式作为后备 |
| v_forecast_coverage查询慢 | 汇总视图卡顿 | 低 | 添加索引+物化视图 |
| 多周分配导致数据不一致 | 数据错误 | 低 | 使用数据库事务+乐观锁 |

---

## 下一步行动

### 立即可执行（本周）
1. **产品团队：** 评审本需求文档，确认优先级
2. **系统架构师：** 设计`v_forecast_coverage_aggregated`视图和批量操作API
3. **设计团队：** 创建矩阵表格和汇总视图的高保真原型

### 2周内
1. **前端团队：** 实现问题2的UI改版（重命名+帮助文本）
2. **后端团队：** 实现问题3 Phase 1的汇总视图查询逻辑
3. **QA团队：** 编写矩阵表格和批量分配的测试用例

### 1个月内
1. 完成问题3 Phase 1的开发和测试
2. 启动问题1矩阵表格的开发
3. 进行用户可用性测试（5-10名真实用户）

---

## 附录：关键引用

**当前实现文件路径：**
- 销量预测页面：`/Users/tony/Desktop/rolloy-scm/src/app/planning/forecasts/page.tsx`
- PSI报表：`/Users/tony/Desktop/rolloy-scm/src/app/inventory/psi-table/page.tsx`
- 算法验证：`/Users/tony/Desktop/rolloy-scm/src/app/inventory/algorithm-audit/page.tsx`
- 需求覆盖：`/Users/tony/Desktop/rolloy-scm/src/app/planning/forecast-coverage/page.tsx`

**相关数据库视图：**
- `v_forecast_coverage`：当前覆盖率明细视图
- `v_inventory_projection_12weeks`：12周库存预测
- `v_replenishment_suggestions`：补货建议

**核心表：**
- `sales_forecasts`：销量预测主表
- `purchase_order_items`：采购订单明细
- `forecast_order_allocations`：预测-订单分配关系

---

**文档版本：** 1.0
**下次更新：** 待系统架构师技术方案评审后
**联系人：** Product Director (Claude AI)
